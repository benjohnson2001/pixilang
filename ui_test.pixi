include "ui.pixi"

//set_pixel_size(WINDOW_XSIZE / 480)
resize(get_screen(), WINDOW_XSIZE, WINDOW_YSIZE)

PADDING = 32

$ui = UI()
$screen = $ui.Screen($ui)
$canvas = $ui.Canvas($ui, $screen, PADDING, PADDING, $screen.w - 2 * PADDING, $screen.h - 2 * PADDING, #000000)

$min_size = $canvas.w if $min_size > $canvas.h {$min_size = $canvas.h}

$push1 = $ui.Push($ui, $canvas, $min_size + 32, 0, 32, 32, RED)
$push2 = $ui.Push($ui, $canvas, $min_size + 96, 0, 32, 32, #55aa44)
$vslider = $ui.VSlider($ui, $canvas, $min_size + 160, 0, 32, 256, #ffffff)
$hslider = $ui.HSlider($ui, $canvas, $min_size + 32, 320, 256, 32, #99aaff)
$pad = $ui.Pad($ui, $canvas, 0, 0, $min_size, $min_size, #99aaff)

fn gl_cb($ui) {
    set_screen(GL_SCREEN)
    $ui.draw($ui)
    set_screen($ui.screen)
}

set_gl_callback(gl_cb, $ui)

while (1) {
    //$ui.draw($ui)

    while get_event() {
        $evt_type = EVT[EVT_TYPE]
        $evt_key = EVT[EVT_KEY]

        if $evt_type == EVT_QUIT {
            breakall
        }
        if
            ($evt_type == EVT_MOUSEBUTTONDOWN
            || $evt_type == EVT_MOUSEMOVE) && $evt_key == KEY_MOUSE_LEFT
        {
            $ui.evt_dispatch($ui)
        }
    }
    frame()
}

set_gl_callback(-1)
